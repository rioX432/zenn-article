---
title: "macOS 26 (Tahoe) ã§ security ã‚³ãƒãƒ³ãƒ‰ã®ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³å‡ºåŠ›ãŒå¤‰ã‚ã£ãŸ"
emoji: "ğŸ”‘"
type: "tech"
topics: ["macos", "security", "keychain", "shell"]
published: true
---

macOS 26 (Tahoe) ã§ `security find-generic-password -w` ã®å‡ºåŠ›å½¢å¼ãŒå¤‰ã‚ã£ãŸã€‚ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒ **HEXã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰** ã§è¿”ã£ã¦ãã‚‹ã‚ˆã†ã«ãªã‚Šã€ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’èª­ã‚€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå£Šã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

## ä½•ãŒèµ·ããŸã‹

Claude Codeã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã«ä½¿ç”¨é‡ï¼ˆ`5h:79% 7d:68%` ã®ã‚ˆã†ãªè¡¨ç¤ºï¼‰ã‚’å‡ºã™ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã£ã¦ã„ãŸã€‚macOS 26ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã‚‰ã€ã“ã®è¡¨ç¤ºãŒå‡ºãªããªã£ãŸã€‚

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è©²å½“ç®‡æ‰€ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚

```bash
# ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰Claude Codeã®èªè¨¼æƒ…å ±ã‚’å–å¾—
CREDS=$(security find-generic-password -s "Claude Code-credentials" -w 2>/dev/null)
# jqã§ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŠœãå‡ºã™
TOKEN=$(echo "$CREDS" | jq -r '.claudeAiOauth.accessToken')
```

`$CREDS` ã«ã¯JSONãŒå…¥ã£ã¦ã„ã‚‹å‰æã ã£ãŸã€‚ã§ã‚‚ macOS 26 ã§ã¯ `security -w` ãŒ JSON ã§ã¯ãªã HEXæ–‡å­—åˆ—ã‚’è¿”ã™ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€`jq` ã®ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¦ã„ãŸã€‚

## ä½•ãŒå¤‰ã‚ã£ãŸã®ã‹

`security find-generic-password -w` ã¯ã€ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã«ä¿å­˜ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨™æº–å‡ºåŠ›ã«è¿”ã™ã‚³ãƒãƒ³ãƒ‰ã€‚ã“ã‚Œã¾ã§ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¸­èº«ãŒãã®ã¾ã¾æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã¦ã„ãŸã€‚

macOS 26 ã§ã¯ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ASCIIç¯„å›²å¤–ã®æ–‡å­—ã‚„ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€å‡ºåŠ›ãŒ HEX ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

```bash
# macOS 15 ä»¥å‰
$ security find-generic-password -s "my-service" -w
{"token":"sk-ant-...","refreshToken":"sk-ant-..."}

# macOS 26
$ security find-generic-password -s "my-service" -w
7B22746F6B656E223A22736B2D616E742D2E2E2E222C22726566726573...
```

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå˜ç´”ãªASCIIæ–‡å­—åˆ—ã®å ´åˆã¯ä»¥å‰ã¨åŒã˜å‡ºåŠ›ã«ãªã‚‹ãŒã€JSONã«å«ã¾ã‚Œã‚‹ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ã‚„ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒãƒˆãƒªã‚¬ãƒ¼ã«ãªã£ã¦ HEX å‡ºåŠ›ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

### `-w` ãƒ•ãƒ©ã‚°ã®åˆ‡ã‚Šè©°ã‚å•é¡Œ

ã‚‚ã†ä¸€ã¤å„ä»‹ãªã®ãŒã€`-w` ãƒ•ãƒ©ã‚°ã«ã¯ **2015ãƒã‚¤ãƒˆã®åˆ‡ã‚Šè©°ã‚**ï¼ˆtruncationï¼‰ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚‹ç‚¹ã€‚Claude Codeã®èªè¨¼æƒ…å ±ã¯OAuthãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚“ã§ã„ã¦é•·ã„ã€‚HEXã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã¨å…ƒã®ãƒ‡ãƒ¼ã‚¿ã®2å€ã®é•·ã•ã«ãªã‚‹ã®ã§ã€åˆ‡ã‚Šè©°ã‚ãŒèµ·ãã‚„ã™ããªã‚‹ã€‚

åˆ‡ã‚Šè©°ã‚ã‚‰ã‚ŒãŸHEXæ–‡å­—åˆ—ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã‚‚ã€é€”ä¸­ã§åˆ‡ã‚ŒãŸä¸å®Œå…¨ãªJSONãŒå‡ºã¦ãã‚‹ã ã‘ã€‚`jq` ã§ãƒ‘ãƒ¼ã‚¹ã—ã‚ˆã†ã¨ã—ã¦ã‚‚å½“ç„¶ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚

## èª¿æŸ»ã®éç¨‹

æœ€åˆã¯ã€ŒClaude Codeã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã£ã¦ä½•ã‹å¤‰ã‚ã£ãŸã®ã‹ãªã€ã¨æ€ã£ãŸã€‚ã§ã‚‚Claude Codeè‡ªä½“ã¯æ­£å¸¸ã«å‹•ã„ã¦ã„ã‚‹ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã ã‘ãŒãŠã‹ã—ã„ã€‚

`security find-generic-password -w` ã®å‡ºåŠ›ã‚’ç›´æ¥è¦‹ã¦ã¿ãŸã‚‰ã€è¦‹æ…£ã‚Œãªã„HEXæ–‡å­—åˆ—ãŒå‡ºã¦ããŸã€‚

```bash
$ security find-generic-password -s "Claude Code-credentials" -w | head -c 100
7B22636C61756465416941757468223A7B226163636573...
```

ã“ã‚Œã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã¿ã‚‹ã€‚

```bash
$ security find-generic-password -s "Claude Code-credentials" -w | xxd -r -p | head -c 100
{"claudeAiAuth":{"acces...
```

JSON ã ã£ãŸã€‚`security` ã‚³ãƒãƒ³ãƒ‰ãŒHEXã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦è¿”ã—ã¦ã„ãŸã“ã¨ãŒç¢ºèªã§ããŸã€‚

macOS 26 ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹å‰ã¯åŒã˜ã‚³ãƒãƒ³ãƒ‰ã§ç”Ÿã®JSONãŒè¿”ã£ã¦ã„ãŸã®ã§ã€OSã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ `security` ã‚³ãƒãƒ³ãƒ‰ã®å‹•ä½œãŒå¤‰ã‚ã£ãŸã“ã¨ãŒã‚ã‹ã£ãŸã€‚

## å¯¾å‡¦æ³•

### æ–¹æ³•1: ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç›´æ¥èª­ã‚€

Claude Codeã®å ´åˆã€èªè¨¼æƒ…å ±ã¯ `~/.claude/.credentials.json` ã«ã‚‚ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‚’çµŒç”±ã›ãšã€ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã‚€ã®ãŒä¸€ç•ªç¢ºå®Ÿã€‚

```bash
# ä¿®æ­£å‰
CREDS=$(security find-generic-password -s "Claude Code-credentials" -w 2>/dev/null)

# ä¿®æ­£å¾Œ
CREDS=$(cat ~/.claude/.credentials.json 2>/dev/null)
```

1è¡Œã®ä¿®æ­£ã§ç›´ã£ãŸã€‚

### æ–¹æ³•2: HEXãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹

ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰èª­ã‚€å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€å‡ºåŠ›ã‚’ `xxd` ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã€‚

```bash
CREDS_RAW=$(security find-generic-password -s "my-service" -w 2>/dev/null)

# HEXã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¦ãƒ‡ã‚³ãƒ¼ãƒ‰
if [[ "$CREDS_RAW" =~ ^[0-9A-Fa-f]+$ ]]; then
  CREDS=$(echo "$CREDS_RAW" | xxd -r -p)
else
  CREDS="$CREDS_RAW"
fi
```

`xxd -r -p` ã¯ã€ãƒ—ãƒ¬ãƒ¼ãƒ³ãªHEXæ–‡å­—åˆ—ã‚’ãƒã‚¤ãƒŠãƒªã«æˆ»ã™ã‚³ãƒãƒ³ãƒ‰ã€‚`-r` ãŒãƒªãƒãƒ¼ã‚¹ï¼ˆHEXâ†’ãƒã‚¤ãƒŠãƒªï¼‰ã€`-p` ãŒãƒ—ãƒ¬ãƒ¼ãƒ³HEXå½¢å¼ã®æŒ‡å®šã€‚

ãŸã ã—ã€å‰è¿°ã®2015ãƒã‚¤ãƒˆåˆ‡ã‚Šè©°ã‚å•é¡ŒãŒã‚ã‚‹ã®ã§ã€é•·ã„ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã«ä¿å­˜ã—ã¦ã„ã‚‹å ´åˆã¯ã“ã®æ–¹æ³•ã§ã‚‚ä¸å®Œå…¨ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚å¯èƒ½ãªã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã‚€æ–¹ãŒã„ã„ã€‚

## å½±éŸ¿ç¯„å›²

ã“ã®å•é¡Œã¯Claude Codeã«é™ã£ãŸè©±ã§ã¯ãªã„ã€‚`security find-generic-password -w` ã‚’ä½¿ã£ã¦ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’èª­ã‚“ã§ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€macOS 26 ã§åŒã˜å•é¡Œã«é­é‡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

ã™ã§ã«å ±å‘ŠãŒä¸ŠãŒã£ã¦ã„ã‚‹ã‚‚ã®:

- **fastlane** â€” ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’èª­ã‚€æ­£è¦è¡¨ç¾ãŒ HEXå‡ºåŠ›ã«å¯¾å¿œã—ã¦ãŠã‚‰ãšã€æ¯å›ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹å•é¡ŒãŒå ±å‘Šã•ã‚Œã¦ã„ã‚‹ï¼ˆ[Issue #20952](https://github.com/fastlane/fastlane/issues/20952)ï¼‰
- **keyring-rs** â€” Rustã®ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€HEXå‡ºåŠ›ã®ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¦ãƒ‘ãƒ‹ãƒƒã‚¯ã™ã‚‹å•é¡Œï¼ˆ[Issue #19](https://github.com/hwchen/keyring-rs/issues/19)ï¼‰
- **Claude Code** â€” OAuthèªè¨¼ãŒã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã§æ°¸ç¶šåŒ–ã•ã‚Œãªã„å•é¡Œï¼ˆ[Issue #9403](https://github.com/anthropics/claude-code/issues/9403)ï¼‰

è‡ªä½œã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦ã„ã‚‹äººã¯ã€macOS 26 ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèªã—ã¦ãŠãã®ãŒã„ã„ã€‚

```bash
# è‡ªåˆ†ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ security -w ã‚’ä½¿ã£ã¦ã„ã‚‹ã‹ç¢ºèª
grep -r "find-generic-password.*-w" ~/scripts/ ~/.config/
```

## å‚è€ƒ

- [Scripting OS X: Get Password from Keychain in Shell Scripts](https://scriptingosx.com/2021/04/get-password-from-keychain-in-shell-scripts/)
- [keyring-rs Issue #19: MacOS error reading hex output](https://github.com/hwchen/keyring-rs/issues/19)
- [fastlane Issue #20952: fails to read from keychain](https://github.com/fastlane/fastlane/issues/20952)
- [Claude Code Issue #9403: macOS Keychain OAuth persistence](https://github.com/anthropics/claude-code/issues/9403)
